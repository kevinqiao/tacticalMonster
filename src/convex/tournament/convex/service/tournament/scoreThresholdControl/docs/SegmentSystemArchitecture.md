# æ®µä½ç³»ç»Ÿæ¶æ„è¯´æ˜

## ğŸ† æ®µä½ç³»ç»Ÿæ¦‚è¿°

æœ¬ç³»ç»ŸåŒ…å«ä¸¤å¥—ç‹¬ç«‹çš„æ®µä½ç³»ç»Ÿï¼Œå„è‡ªæœåŠ¡äºä¸åŒçš„ç›®çš„ï¼š

### 1. å®æ—¶æŠ€èƒ½æ®µä½ï¼ˆUnifiedSkillAssessmentï¼‰
- **ç”¨é€”**ï¼šå†…éƒ¨æ’åæ¨èå’ŒæŠ€èƒ½è¯„ä¼°
- **è®¡ç®—æ–¹å¼**ï¼šåŸºäºæœ€è¿‘50åœºæ¯”èµ›å®æ—¶è®¡ç®—
- **å¯è§æ€§**ï¼šå¯¹ç©å®¶ä¸é€æ˜ï¼Œä»…ç³»ç»Ÿå†…éƒ¨ä½¿ç”¨
- **æ›´æ–°é¢‘ç‡**ï¼šæ¯æ¬¡æ’åæ¨èæ—¶é‡æ–°è®¡ç®—
- **æ®µä½ç­‰çº§**ï¼š`bronze` | `silver` | `gold` | `platinum` | `diamond`

### 2. ç§¯åˆ†ç´¯ç§¯æ®µä½ï¼ˆSegmentManagerï¼‰
- **ç”¨é€”**ï¼šç©å®¶å¯è§çš„æ®µä½ç³»ç»Ÿ
- **è®¡ç®—æ–¹å¼**ï¼šåŸºäºé”¦æ ‡èµ›å¥–åŠ±ç§¯åˆ†ç´¯ç§¯
- **å¯è§æ€§**ï¼šç©å®¶å¯è§ï¼Œæ˜¾ç¤ºåœ¨UIä¸Š
- **æ›´æ–°é¢‘ç‡**ï¼šæ¯æ¬¡ç§¯åˆ†å˜åŒ–æ—¶æ£€æŸ¥
- **æ®µä½ç­‰çº§**ï¼š`bronze` | `silver` | `gold` | `platinum` | `diamond` | `master` | `grandmaster`

## ğŸ”„ ä¸¤å¥—ç³»ç»Ÿçš„å…³ç³»

### å®æ—¶æŠ€èƒ½æ®µä½ â†’ ç§¯åˆ†ç´¯ç§¯æ®µä½
```typescript
// å®æ—¶æŠ€èƒ½æ®µä½å½±å“ç§¯åˆ†å¥–åŠ±
const skillLevel = unifiedSkillAssessment.assessPlayerSkill(profile);
const pointsReward = calculatePointsReward(score, skillLevel.level);
await segmentManager.updatePoints(uid, pointsReward);
```

### ç§¯åˆ†ç´¯ç§¯æ®µä½ â†’ å®æ—¶æŠ€èƒ½æ®µä½
```typescript
// ç§¯åˆ†ç´¯ç§¯æ®µä½æä¾›åŸºç¡€å‚è€ƒ
const playerSegment = await segmentManager.getPlayerSegmentInfo(uid);
const skillAssessment = unifiedSkillAssessment.assessPlayerSkill(profile);
// ä½†æœ€ç»ˆæ’åæ¨èä½¿ç”¨å®æ—¶è®¡ç®—çš„æŠ€èƒ½æ®µä½
```

## ğŸ“Š ä½¿ç”¨åœºæ™¯å¯¹æ¯”

| åœºæ™¯ | ä½¿ç”¨ç³»ç»Ÿ | åŸå›  |
|------|----------|------|
| æ’åæ¨è | å®æ—¶æŠ€èƒ½æ®µä½ | åæ˜ å½“å‰çœŸå®æŠ€èƒ½æ°´å¹³ |
| ç§å­æ¨è | å®æ—¶æŠ€èƒ½æ®µä½ | åŸºäºå†å²è¡¨ç°åŒ¹é…å¯¹æ‰‹ |
| æ®µä½æ¦‚ç‡ | å®æ—¶æŠ€èƒ½æ®µä½ | åŸºäºå½“å‰æŠ€èƒ½æ°´å¹³è°ƒæ•´æ¦‚ç‡ |
| UIæ˜¾ç¤º | ç§¯åˆ†ç´¯ç§¯æ®µä½ | ç©å®¶å¯è§çš„æˆå°±ç³»ç»Ÿ |
| ç§¯åˆ†å¥–åŠ± | ç§¯åˆ†ç´¯ç§¯æ®µä½ | åŸºäºæ®µä½è§„åˆ™è®¡ç®—å¥–åŠ± |
| æ®µä½ä¿æŠ¤ | ç§¯åˆ†ç´¯ç§¯æ®µä½ | ä¿æŠ¤ç©å®¶å·²è·å¾—çš„æ®µä½ |

## ğŸ› ï¸ æŠ€æœ¯å®ç°

### å®æ—¶æŠ€èƒ½æ®µä½è®¡ç®—
```typescript
// åœ¨ RankingRecommendationManager ä¸­
const skillAssessment = this.skillAssessment.assessPlayerSkill({
    uid,
    segmentName: 'bronze', // ä¸´æ—¶å€¼
    averageScore,
    averageRank,
    winRate,
    totalMatches: recentMatches.length,
    recentPerformance: {
        last10Matches,
        trendDirection,
        consistency
    }
});
const segmentName = skillAssessment.level as SegmentName;
```

### ç§¯åˆ†ç´¯ç§¯æ®µä½ç®¡ç†
```typescript
// åœ¨ SegmentManager ä¸­
const segmentChangeResult = await segmentManager.updatePoints(uid, pointsDelta);
if (segmentChangeResult.changed) {
    // æ›´æ–°ç©å®¶å¯è§çš„æ®µä½
    await updatePlayerVisibleSegment(uid, segmentChangeResult.newSegment);
}
```

## ğŸ¯ æ®µä½æ¦‚ç‡é…ç½®

### æ”¯æŒçš„å‚ä¸è€…æ•°é‡
- **4äººæ¯”èµ›**ï¼š`[0.25, 0.25, 0.25, 0.25]` åˆ° `[0.55, 0.25, 0.15, 0.05]`
- **6äººæ¯”èµ›**ï¼š`[0.20, 0.20, 0.20, 0.20, 0.10, 0.10]` åˆ° `[0.50, 0.25, 0.15, 0.08, 0.01, 0.01]`
- **8äººæ¯”èµ›**ï¼š`[0.18, 0.18, 0.18, 0.18, 0.12, 0.08, 0.05, 0.03]` åˆ° `[0.48, 0.25, 0.15, 0.10, 0.01, 0.01, 0.00, 0.00]`

### ä½¿ç”¨æ¡ä»¶
- **å•çœŸäººç©å®¶**ï¼š`humanPlayerCount === 1`
- **æ”¯æŒçš„å‚ä¸è€…æ•°é‡**ï¼š`totalParticipants` åœ¨ `[4, 6, 8]` ä¸­
- **ä½¿ç”¨å®æ—¶æŠ€èƒ½æ®µä½**ï¼šåŸºäº `UnifiedSkillAssessment` è®¡ç®—çš„æ®µä½

## ğŸ”§ é…ç½®ç®¡ç†

### å®æ—¶æŠ€èƒ½æ®µä½é…ç½®
```typescript
// åœ¨ UnifiedSkillAssessment ä¸­
const defaultThresholds = {
    diamond: 0.9,    // 90%ä»¥ä¸Šä¸ºé’»çŸ³
    platinum: 0.75,  // 75%ä»¥ä¸Šä¸ºé“‚é‡‘
    gold: 0.6,       // 60%ä»¥ä¸Šä¸ºé»„é‡‘
    silver: 0.4,     // 40%ä»¥ä¸Šä¸ºç™½é“¶
    bronze: 0.0      // å…¶ä»–ä¸ºé’é“œ
};
```

### ç§¯åˆ†ç´¯ç§¯æ®µä½é…ç½®
```typescript
// åœ¨ segment/config.ts ä¸­
export const SEGMENT_RULES: Record<SegmentName, SegmentRule> = {
    bronze: {
        promotion: { pointsRequired: 1000, winRateRequired: 0.4, ... },
        demotion: { pointsThreshold: -200, consecutiveLosses: 5, ... },
        rankingProbabilities: { 4: [...], 6: [...], 8: [...] }
    },
    // ... å…¶ä»–æ®µä½
};
```

## ğŸ“ˆ æ€§èƒ½è€ƒè™‘

### å®æ—¶æŠ€èƒ½æ®µä½
- **ä¼˜ç‚¹**ï¼šå‡†ç¡®åæ˜ å½“å‰æŠ€èƒ½æ°´å¹³
- **ç¼ºç‚¹**ï¼šæ¯æ¬¡éƒ½éœ€è¦é‡æ–°è®¡ç®—
- **ä¼˜åŒ–**ï¼šå¯ä»¥æ·»åŠ ç¼“å­˜æœºåˆ¶

### ç§¯åˆ†ç´¯ç§¯æ®µä½
- **ä¼˜ç‚¹**ï¼šè®¡ç®—ç®€å•ï¼Œæ€§èƒ½å¥½
- **ç¼ºç‚¹**ï¼šå¯èƒ½æ»åäºçœŸå®æŠ€èƒ½æ°´å¹³
- **ä¼˜åŒ–**ï¼šå®šæœŸåŒæ­¥ä¸¤å¥—ç³»ç»Ÿ

## ğŸ® ç”¨æˆ·ä½“éªŒ

### ç©å®¶è§†è§’
- çœ‹åˆ°çš„æ˜¯ç§¯åˆ†ç´¯ç§¯æ®µä½ï¼ˆUIæ˜¾ç¤ºï¼‰
- æ„Ÿå—åˆ°çš„æ˜¯åŸºäºå®æ—¶æŠ€èƒ½æ®µä½çš„æ’åæ¨è
- è·å¾—çš„æ˜¯åŸºäºç§¯åˆ†ç´¯ç§¯æ®µä½çš„å¥–åŠ±å’Œä¿æŠ¤

### ç³»ç»Ÿè§†è§’
- ä½¿ç”¨å®æ—¶æŠ€èƒ½æ®µä½è¿›è¡Œå†…éƒ¨è®¡ç®—
- ä½¿ç”¨ç§¯åˆ†ç´¯ç§¯æ®µä½è¿›è¡Œç”¨æˆ·äº¤äº’
- ä¸¤å¥—ç³»ç»Ÿç›¸äº’ç‹¬ç«‹ä½†åè°ƒå·¥ä½œ

## ğŸ”® æœªæ¥æ‰©å±•

### å¯èƒ½çš„æ”¹è¿›
1. **æ®µä½åŒæ­¥æœºåˆ¶**ï¼šå®šæœŸåŒæ­¥ä¸¤å¥—ç³»ç»Ÿ
2. **æ··åˆæ®µä½ç³»ç»Ÿ**ï¼šç»“åˆä¸¤å¥—ç³»ç»Ÿçš„ä¼˜åŠ¿
3. **åŠ¨æ€æƒé‡è°ƒæ•´**ï¼šæ ¹æ®ç©å®¶ç±»å‹è°ƒæ•´æƒé‡
4. **ä¸ªæ€§åŒ–é…ç½®**ï¼šå…è®¸ç©å®¶è‡ªå®šä¹‰æ®µä½åå¥½

### é…ç½®çµæ´»æ€§
- æ”¯æŒåŠ¨æ€è°ƒæ•´æ®µä½é˜ˆå€¼
- æ”¯æŒæ·»åŠ æ–°çš„æ®µä½ç­‰çº§
- æ”¯æŒè‡ªå®šä¹‰æ®µä½æ¦‚ç‡åˆ†å¸ƒ
- æ”¯æŒA/Bæµ‹è¯•ä¸åŒçš„æ®µä½ç­–ç•¥
